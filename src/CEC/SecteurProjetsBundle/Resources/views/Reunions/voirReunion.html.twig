{% extends 'CECSecteurProjetsBundle::base.html.twig' %}

{% block right %}
{{parent()}}


<div class="well" style = "padding-left:20px;padding-right:15px;">
<h1> Réunions d'informations pour les projets </h1>

<h3> Réunions d'informations existantes</h3>

<table class="table table-bordered table-hover table-large table-striped">
	<tbody>
	{% for projet in projets %}
	<tr>
		<th colspan="7" >
			{{projet.nom}}
		</th>
	</tr>
		{% for reunion in reunions %}
		{% if reunion.projet == projet and date(reunion.date) > date() %}
		<tr id="{{reunion.id}}">
			<td>
				{{reunion.nom}}
			</td>
			<td> 
				Le <strong>{{ cycle(jours, reunion.date|date('N')) }} {{ reunion.date|date('j') }} 
				{{ cycle(mois, reunion.date|date('n')) }} {{ reunion.date|date('Y') }}</strong> de <strong>{{reunion.heureDebut|date('G\\hi')}} 
				à {{reunion.heureFin|date('G\\hi')}}</strong>
			</td>
			<td>
				{{reunion.adresse}}
			</td>
			<td>
				{{reunion.description}}
			</td>
			{% if is_granted('ROLE_SECTEUR_PROJETS') %}
				<td>
					{{reunion.presents|length}} inscrits
				<td>
					<a href="{{path('modifier_reunion', {'id':reunion.id})}}" class="btn btn-default">Modifier</a>
				</td>
				<td>
					<a href="{{path('supprimer_reunion', {'id':reunion.id})}}" class="btn btn-danger">Supprimer</a>
				</td>
			{% elseif is_granted('ROLE_ELEVE') %}
				<td>
					{% if app.user in reunion.presents %}
						<a href="{{path('desinscription_reunion', {'id': reunion.id})}}" class="btn btn-danger">Se désinscrire</a>
					{% else %}
						<a href="{{path('inscription_reunion', {'id': reunion.id})}}" class="btn btn-default">S'inscrire</a>
					{% endif %}
				</td>
			{% endif %}
		</tr>		
		{% endif %}
		{% else %}
		<tr>
			<td class="muted"> Pas de réunions à venir pour ce projet </td>
		</tr>
		{% endfor %} 
	{% endfor %}
	</tbody>
</table>

{% if is_granted('ROLE_SECTEUR_PROJETS') %}
	<h3>Créer une nouvelle réunion d'information</h3>

	{% render('CECSecteurProjetsBundle:Reunions:creerReunion')%}
{% endif %}

</div>

{% endblock %}
